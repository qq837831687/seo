# å…±äº«åŸºç¡€è®¾æ–½ (Shared Infrastructure)

> ä¸­è€å¹´å…»ç”Ÿå†…å®¹å·¥å‚ v2.0 - æ ¸å¿ƒæ•°æ®ä¸åè®®å±‚

---

## ğŸ“ ç›®å½•ç»“æ„

```
Shared_Infrastructure/
â”œâ”€â”€ Persona_Hub.json              # æ ¸å¿ƒäººè®¾åº“
â”œâ”€â”€ Central_Knowledge_Base.json   # ä¸­å¤®çŸ¥è¯†åº“
â”œâ”€â”€ UCO_Schema.md                 # ç»Ÿä¸€å†…å®¹å¯¹è±¡Schema
â”œâ”€â”€ Agent_Knowledge_Mapping.md    # Agent-çŸ¥è¯†åº“æ˜ å°„è¡¨
â”œâ”€â”€ API_Protocol.md               # APIäº¤äº’åè®®
â””â”€â”€ README.md                     # æœ¬æ–‡æ¡£
```

---

## ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

### ä»€ä¹ˆæ˜¯å…±äº«åŸºç¡€è®¾æ–½ï¼Ÿ

å…±äº«åŸºç¡€è®¾æ–½æ˜¯æ•´ä¸ªå†…å®¹å·¥å‚çš„"åº•å±‚åè®®"ï¼Œç¡®ä¿æ‰€æœ‰Agentèƒ½å¤Ÿï¼š
- **è¯´åŒä¸€ç§è¯­è¨€**ï¼šç»Ÿä¸€çš„æ•°æ®æ ¼å¼ï¼ˆJSONï¼‰
- **ç”¨åŒä¸€å¥—æ•°æ®**ï¼šå…±äº«çš„äººè®¾åº“å’ŒçŸ¥è¯†åº“
- **éµå¾ªåŒä¸€å¥—è§„åˆ™**ï¼šæ ‡å‡†åŒ–çš„äº¤äº’åè®®

**ç±»æ¯”**ï¼š
- ğŸ—ï¸ å°±åƒå»ºç­‘çš„åœ°åŸºï¼Œæ‰€æœ‰å»ºç­‘éƒ½ä¾èµ–å®ƒ
- ğŸ“š å°±åƒå›¾ä¹¦é¦†çš„ç´¢å¼•ç³»ç»Ÿï¼Œæ‰€æœ‰ä¹¦éƒ½æŒ‰è§„åˆ™åˆ†ç±»
- ğŸš¦ å°±åƒäº¤é€šè§„åˆ™ï¼Œæ‰€æœ‰è½¦è¾†éƒ½éµå¾ªåŒæ ·çš„ä¿¡å·

---

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### 1. Persona_Hub.json (æ ¸å¿ƒäººè®¾åº“)

**ä½œç”¨**: å®šä¹‰å…¬ä¼—å·çš„ç»Ÿä¸€çµé­‚

**åŒ…å«å†…å®¹**:
- èº«ä»½ä¿¡æ¯ï¼ˆè€æï¼Œ65å²é€€ä¼‘å·¥äººï¼‰
- è¯­è¨€é£æ ¼ï¼ˆæœ´å®ã€çœŸè¯šã€æœ‰æ¸©åº¦ï¼‰
- æ ¸å¿ƒä»·å€¼è§‚ï¼ˆå…»ç”Ÿä¸ºä¸æ‹–ç´¯å®¶äººç­‰ï¼‰
- ä¸“ä¸šé¢†åŸŸï¼ˆä¸­åŒ»é£Ÿç–—ã€è€å¹´æŠ¤ç†ï¼‰
- ç¦ç”¨è¯æ±‡ï¼ˆç½‘ç»œç”¨è¯­ã€å¤¸å¤§è¯æ±‡ï¼‰

**ä½¿ç”¨åœºæ™¯**:
- Agent 3 (æ¶æ„å¸ˆ) è®¾è®¡å¤§çº²æ—¶è¯»å–è¯­æ°”
- Agent 4 (å†™æ‰‹) æ’°å†™æ—¶æ£€æŸ¥ç¦ç”¨è¯
- Agent 5 (å®¡æŸ¥å®˜) æ£€æŸ¥ä¸€è‡´æ€§

**æ›´æ–°é¢‘ç‡**: å¾ˆå°‘ï¼ˆåŸºæœ¬ä¸å˜ï¼‰

---

### 2. Central_Knowledge_Base.json (ä¸­å¤®çŸ¥è¯†åº“)

**ä½œç”¨**: æ•´ä¸ªå·¥å‚çš„å…±äº«å¤§è„‘

**åŒ…å«4ä¸ªå­åº“**:

#### 2.1 Fact_Base (äº‹å®åº“)
```json
ä¸­åŒ»ç†è®º: äº”è¡Œå…»ç”Ÿï¼ˆæ˜¥å…»è‚ã€å¤å…»å¿ƒ...ï¼‰
è¥å…»çŸ¥è¯†: å±±è¯ã€ç”Ÿå§œã€çº¢æ£ç­‰é£ŸæåŠŸæ•ˆ
åŸç†åŸåˆ™: é¡ºæ—¶è€Œé£Ÿã€é€‚åº¦ä¸ºå®œã€å› äººè€Œå¼‚
```

#### 2.2 Opinion_Case_Bank (è§‚ç‚¹æ¡ˆä¾‹åº“)
```json
é‡‘å¥åº“: è€æçš„ç»å…¸è¯­å¥ï¼ˆ"è¿™8å¹´æŠ¤å·¥ç”Ÿæ¶¯..."ï¼‰
æ•…äº‹åº“: 8å¹´æŠ¤å·¥ç»å†ã€å±±è¯ç²¥è°ƒç†ç­‰
é£Ÿç–—æ–¹: å§œèŒ¶ã€é“¶è€³æ±¤ç­‰å®è·µæ–¹æ³•
```

#### 2.3 Asset_Library (ç´ æåº“)
```json
å›¾ç‰‡æ¥æº: é£Ÿç‰©ç…§ç‰‡ã€ä¸­åŒ»æ’å›¾
æƒå¨æ¥æº: å›½å®¶ä¸­åŒ»è¯ç®¡ç†å±€ã€ä¸­å›½è¥å…»å­¦ä¼š
åˆè§„è¯å…¸: ç¦ç”¨è¯ã€å®‰å…¨æ›¿ä»£è¯
```

#### 2.4 Feedback_Loop (åé¦ˆé—­ç¯)
```json
æˆåŠŸæ¡£æ¡ˆ: é«˜é˜…è¯»é‡æ–‡ç« ç‰¹å¾
å¤±è´¥æ¡£æ¡ˆ: ä½é˜…è¯»é‡æ–‡ç« é—®é¢˜
å­¦ä¹ æ´å¯Ÿ: è¯»è€…åå¥½ã€å­£èŠ‚è¶‹åŠ¿
ç—…æ¯’æ¨¡å¼: æ ‡é¢˜å…¬å¼ã€å¼€å¤´é’©å­ã€æƒ…ç»ªè§¦å‘å™¨
```

**ä½¿ç”¨åœºæ™¯**:
- Agent 2 (çˆ†æ–‡åˆ†æå¸ˆ) è¯»å–æˆåŠŸæ¡£æ¡ˆå­¦ä¹ æ¨¡å¼
- Agent 4 (å†™æ‰‹) å¼•ç”¨æ•…äº‹å’Œæ¡ˆä¾‹
- Agent 6 (é¢„æµ‹å¸ˆ) å¯¹æ¯”å†å²æ•°æ®é¢„æµ‹çˆ†æ¬¾
- Agent 8 (å¢é•¿é»‘å®¢) å†™å…¥å‘å¸ƒåæ•°æ®

**æ›´æ–°é¢‘ç‡**: ä¸­ç­‰ï¼ˆæ¯æ¬¡å‘å¸ƒåæ›´æ–°åé¦ˆé—­ç¯ï¼‰

---

### 3. UCO_Schema.md (ç»Ÿä¸€å†…å®¹å¯¹è±¡)

**ä½œç”¨**: æµæ°´çº¿ä¸Šçš„"å·¥å•"ï¼Œè®°å½•æ–‡ç« å®Œæ•´ç”Ÿå‘½å‘¨æœŸ

**æ ¸å¿ƒä»·å€¼**:
- ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼šæ‰€æœ‰Agentç”¨åŒä¸€ç§è¯­è¨€äº¤æµ
- çŠ¶æ€è¿½è¸ªï¼šéšæ—¶çŸ¥é“æ–‡ç« åˆ°å“ªä¸€æ­¥äº†
- å¯è¿½æº¯ï¼šæ¯ä¸ªä¿®æ”¹éƒ½æœ‰è®°å½•ï¼Œå¯å›æ»š
- å¯å¹¶å‘ï¼šå¤šç¯‡æ–‡ç« åŒæ—¶å¤„ç†ä¸ä¼šæ··ä¹±

**çŠ¶æ€æµè½¬**:
```
INIT â†’ TRENDING â†’ TOPIC_SELECTED â†’ ANALYZING
â†’ OUTLINING â†’ OUTLINED â†’ DRAFTING â†’ DRAFTED
â†’ REVIEWING â†’ REVIEWED â†’ OPTIMIZING â†’ OPTIMIZED
â†’ READY â†’ PUBLISHED â†’ ARCHIVED
```

**ä½¿ç”¨åœºæ™¯**:
- ä¸­æ¢è°ƒåº¦å™¨ç›‘æ§UCOçŠ¶æ€
- Agentè¯»å–éœ€è¦çš„å­—æ®µ
- Agentå†™å…¥äº§å‡ºçš„æ•°æ®
- è¿½è¸ªé—®é¢˜å’Œå›æ»šç‰ˆæœ¬

---

### 4. Agent_Knowledge_Mapping.md (æ˜ å°„è¡¨)

**ä½œç”¨**: å®šä¹‰æ¯ä¸ªAgentåœ¨ç‰¹å®šæ—¶åˆ»è°ƒç”¨å“ªäº›æ•°æ®

**ç¤ºä¾‹**:
```yaml
Agent 4 (ç‹ç‰Œå†™æ‰‹):
  è¯»å–: persona.linguistic_style
        knowledge.story_database
        knowledge.fact_base
  å†™å…¥: content.full_text
        content.annotations
```

**ä»·å€¼**:
- æ ‡å‡†åŒ–Agentçš„æ•°æ®è®¿é—®
- é¿å…Agent"çŒœæµ‹"è¯¥ç”¨ä»€ä¹ˆæ•°æ®
- ä»"äººå·¥åä½œ"åˆ°"å·¥ä¸šåŒ–ç”Ÿäº§"

---

### 5. API_Protocol.md (APIåè®®)

**ä½œç”¨**: å®šä¹‰Agentå¦‚ä½•ç¨‹åºåŒ–åœ°è®¿é—®äººè®¾åº“å’ŒçŸ¥è¯†åº“

**APIç¤ºä¾‹**:
```http
GET /api/v1/persona/linguistic_style/forbidden_words
â†’ è¿”å›: ["yyds", "ç»ç»å­", "666"]

GET /api/v1/knowledge/story_database?tag=è„¾èƒƒè™šå¯’
â†’ è¿”å›: [story_002: å±±è¯ç²¥è°ƒç†è„¾èƒƒ]

POST /api/v1/knowledge/feedback_loop
Body: {article_id: "art_001", views: 10000}
â†’ å†™å…¥æ€§èƒ½æ•°æ®
```

**ç‰¹æ€§**:
- RESTfulé£æ ¼
- JSONæ ¼å¼
- é”™è¯¯å¤„ç†
- æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ã€æ‰¹é‡ï¼‰

---

## ğŸ”„ æ•°æ®æµè½¬

### å®Œæ•´æµç¨‹ç¤ºä¾‹

```yaml
# 1. ç”¨æˆ·è¾“å…¥
ç”¨æˆ·è¾“å…¥: "æ˜¥å¤©å…»è‚"
â†’ åˆ›å»ºUCOï¼ŒçŠ¶æ€: INIT

# 2. Agent 1 (è¶‹åŠ¿è§‚å¯Ÿå‘˜)
è¯»å–: persona.value_system
å†™å…¥: research_payload.hot_trends
çŠ¶æ€: INIT â†’ TRENDING â†’ TOPIC_SELECTED

# 3. Agent 2 (çˆ†æ–‡åˆ†æå¸ˆ)
è¯»å–: knowledge.success_archives
å†™å…¥: research_payload.viral_analysis
çŠ¶æ€: TOPIC_SELECTED â†’ ANALYZED

# 4. Agent 3 (é¦–å¸­æ¶æ„å¸ˆ)
è¯»å–: persona.linguistic_style
      knowledge.opinion_bank
å†™å…¥: structure
çŠ¶æ€: ANALYZED â†’ OUTLINED

# 5. Agent 4 (ç‹ç‰Œå†™æ‰‹)
è¯»å–: persona.linguistic_style (å…¨é‡)
      knowledge.story_database
      knowledge.fact_base
å†™å…¥: content.full_text
çŠ¶æ€: OUTLINED â†’ DRAFTED

# 6. Agent 5 (é¦–å¸­å®¡æŸ¥å®˜)
è¯»å–: persona.full
      knowledge.fact_base
å†™å…¥: qa_report
çŠ¶æ€: DRAFTED â†’ REVIEWED

# 7. Agent 6+7 (é¢„æµ‹+æ ‡é¢˜)
è¯»å–: knowledge.success_archives
å†™å…¥: optimization, content.headlines
çŠ¶æ€: REVIEWED â†’ OPTIMIZED â†’ READY

# 8. Agent 8 (å¢é•¿é»‘å®¢)
è¯»å–: -
å†™å…¥: publication.urls, feedback_loop
çŠ¶æ€: READY â†’ PUBLISHED
```

---

## ğŸ› ï¸ ä½¿ç”¨æŒ‡å—

### å¯¹äºå¼€å‘è€…

#### é›†æˆåˆ°æ–°Agent

```python
# Agentä»£ç ç¤ºä¾‹
class MyAgent:
    def run(self, uco):
        # 1. è¯»å–éœ€è¦çš„å­—æ®µ
        persona_style = api.get("/persona/linguistic_style")
        stories = api.get("/knowledge/story_database", {"tag": "è„¾èƒƒè™šå¯’"})

        # 2. æ‰§è¡Œé€»è¾‘
        result = self.process(persona_style, stories)

        # 3. å†™å…¥äº§å‡º
        uco.my_field = result
        return uco
```

#### æ›´æ–°äººè®¾æˆ–çŸ¥è¯†åº“

```bash
# 1. ç¼–è¾‘JSONæ–‡ä»¶
vim Shared_Infrastructure/Persona_Hub.json

# 2. æ›´æ–°æ—¶é—´æˆ³
"last_updated": "2026-01-20T12:00:00Z"

# 3. é€šçŸ¥ç›¸å…³Agent
ï¼ˆæˆ–ç­‰å¾…ä¸‹æ¬¡è‡ªåŠ¨è¯»å–ï¼‰
```

---

### å¯¹äºå†…å®¹ç»´æŠ¤è€…

#### æ·»åŠ æ–°é‡‘å¥

```json
// åœ¨ Central_Knowledge_Base.json ä¸­
{
  "quotations": {
    "old_li_quotes": [
      {
        "quote_id": "quote_006",
        "text": "ä½ çš„æ–°é‡‘å¥",
        "context": "ä½¿ç”¨åœºæ™¯",
        "emotion": "æƒ…æ„Ÿ",
        "usage_frequency": "medium",
        "effectiveness": 8.5
      }
    ]
  }
}
```

#### æ·»åŠ æ–°æ•…äº‹

```json
{
  "personal_stories": [
    {
      "story_id": "story_004",
      "title": "æ•…äº‹æ ‡é¢˜",
      "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"],
      "summary": "ä¸€å¥è¯æ€»ç»“",
      "key_takeaway": "æ ¸å¿ƒè¦ç‚¹",
      "emotional_arc": {
        "opening": "å¼€å¤´",
        "middle": "ç»è¿‡",
        "climax": "é«˜æ½®",
        "ending": "ç»“å°¾"
      }
    }
  ]
}
```

#### è®°å½•æ–‡ç« æ•°æ®

```json
{
  "feedback_loop": {
    "article_id": "art_001",
    "publish_date": "2026-01-20",
    "metrics": {
      "views": 10000,
      "shares": 500,
      "saves": 200,
      "comments": 50
    },
    "final_classification": "SUCCESS",
    "lessons_learned": "æƒ…ç»ªä»·å€¼é«˜ï¼Œé‡‘å¥å¯†åº¦é€‚ä¸­"
  }
}
```

---

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### ç›‘æ§æŒ‡æ ‡

```yaml
äººè®¾åº“:
  - æœ€åæ›´æ–°æ—¶é—´
  - å­—æ®µå®Œæ•´æ€§
  - ä½¿ç”¨é¢‘ç‡

çŸ¥è¯†åº“:
  - æ•…äº‹æ•°é‡
  - é‡‘å¥æ•°é‡
  - åé¦ˆæ•°æ®é‡
  - æ›´æ–°é¢‘ç‡

API:
  - å“åº”æ—¶é—´
  - è°ƒç”¨é¢‘ç‡
  - é”™è¯¯ç‡
  - ç¼“å­˜å‘½ä¸­ç‡
```

### ç»´æŠ¤å»ºè®®

```yaml
æ¯æ—¥:
  - æ£€æŸ¥APIé”™è¯¯æ—¥å¿—
  - ç›‘æ§å“åº”æ—¶é—´

æ¯å‘¨:
  - æ›´æ–°åé¦ˆé—­ç¯æ•°æ®
  - åˆ†ææˆåŠŸ/å¤±è´¥æ¨¡å¼

æ¯æœˆ:
  - è¯„å®¡äººè®¾æ˜¯å¦éœ€è¦è°ƒæ•´
  - æ¸…ç†è¿‡æœŸæ•°æ®
  - ä¼˜åŒ–çŸ¥è¯†åº“ç»“æ„

æ¯å­£åº¦:
  - å…¨é¢å®¡æŸ¥åŸºç¡€è®¾æ–½
  - æ€§èƒ½ä¼˜åŒ–
  - ç‰ˆæœ¬å‡çº§
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®ä¸€è‡´æ€§

```yaml
è§„åˆ™:
  - æ‰€æœ‰æ•°æ®å¿…é¡»æ˜¯JSONæ ¼å¼
  - æ—¶é—´ç»Ÿä¸€ä½¿ç”¨ISO8601
  - IDç»Ÿä¸€ä½¿ç”¨UUID-v4

ç¦æ­¢:
  - ç›´æ¥ä¿®æ”¹è¿è¡Œä¸­çš„UCO
  - è·³è¿‡APIç›´æ¥è¯»å†™JSON
  - ä½¿ç”¨å·²åºŸå¼ƒçš„å­—æ®µ
```

### æ€§èƒ½ä¼˜åŒ–

```yaml
ç¼“å­˜ç­–ç•¥:
  - Persona_Hub.json: ç¼“å­˜1å°æ—¶
  - Knowledge_Base: ç¼“å­˜5åˆ†é’Ÿ
  - UCO status: å®æ—¶ï¼ˆä¸ç¼“å­˜ï¼‰

æ‰¹é‡æ“ä½œ:
  - ä¼˜å…ˆä½¿ç”¨æ‰¹é‡API
  - é¿å…é¢‘ç¹å°è¯·æ±‚
```

### å®‰å…¨ä¸æƒé™

```yaml
æƒé™æ§åˆ¶:
  - è¯»å–: æ‰€æœ‰Agent
  - å†™å…¥: ç‰¹å®šAgent
  - ä¿®æ”¹äººè®¾: ä»…Agent_10

APIå¯†é’¥:
  - æ¯ä¸ªAgentç‹¬ç«‹å¯†é’¥
  - å®šæœŸè½®æ¢
  - è®°å½•è®¿é—®æ—¥å¿—
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šç†è§£ç»“æ„

```bash
# æŸ¥çœ‹äººè®¾åº“
cat Shared_Infrastructure/Persona_Hub.json

# æŸ¥çœ‹çŸ¥è¯†åº“
cat Shared_Infrastructure/Central_Knowledge_Base.json

# ç†è§£UCO
cat Shared_Infrastructure/UCO_Schema.md
```

### ç¬¬äºŒæ­¥ï¼šç†Ÿæ‚‰API

```bash
# æŸ¥çœ‹APIæ–‡æ¡£
cat Shared_Infrastructure/API_Protocol.md

# æŸ¥çœ‹æ˜ å°„è¡¨
cat Shared_Infrastructure/Agent_Knowledge_Mapping.md
```

### ç¬¬ä¸‰æ­¥ï¼šå¼€å§‹ä½¿ç”¨

```python
# åœ¨Agentä¸­ä½¿ç”¨
from skills.health_writer_v2 import Infrastructure

# è¯»å–äººè®¾
persona = Infrastructure.get_persona("linguistic_style")

# è¯»å–çŸ¥è¯†åº“
stories = Infrastructure.get_knowledge("story_database", tag="è„¾èƒƒè™šå¯’")

# å†™å…¥æ•°æ®
Infrastructure.write_knowledge("feedback_loop", data)
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [çŠ¶æ€æœºå®šä¹‰](../Orchestrator/State_Machine.md)
- [ä¸­æ¢è°ƒåº¦å™¨](../Orchestrator/Orchestrator_Agent.md)
- [å®Œæ•´æ¶æ„](../docs/ARCHITECTURE.md)

---

## ğŸ“ æ”¯æŒ

**ç»´æŠ¤è€…**: Content Factory Team
**æœ€åæ›´æ–°**: 2026-01-20
**ç‰ˆæœ¬**: 2.0

**é—®é¢˜åé¦ˆ**: è¯·åœ¨é¡¹ç›®Issueä¸­æäº¤
